<html>
    <head>
        <link type="text/css" rel="stylesheet" href="static/index_css.css"/>
        <meta charset="UTF-8">
        <title>CALI - Spanish Linguistic proficiency portal</title>
        <script src="https://code.jquery.com/jquery-3.5.1.js"
          integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
          crossorigin="anonymous"></script>
          <script type="text/javascript">
            function handleChange(event,value)
            {
              event.target.value = value;
            }
            function handleChange_checkbox(event)
            {
              event.target.checked = event.target.checked;
            }
            function toggle_block(event,id_str)
            {
              event.preventDefault();
              display_curr = document.getElementsByClassName(id_str)[0].style.display;
              if(display_curr == "none")
              document.getElementsByClassName(id_str+"")[0].style.display = "block";
              else
              document.getElementsByClassName(id_str+"")[0].style.display = "none";
            }
            function validateAndSubmit(event)
            {
              event.preventDefault();
              errors_present = false;
              error_msg = "";
              var num_fields_entered = 0;
              const positive_integer_regex = /^[0-9]+$/u;
              const author_regex = /\b\p{Letter}\p{Letter}*.*/u;
              table_1 = document.getElementById('criteria_block_metrics');
              table_1_rows = table_1.querySelectorAll('tr');
              table_1_rows.forEach((input)=>{
                columns = input.childNodes;
                var fieldname = "";
                for(var i = 0 ; i < columns.length;i++)
                {
                  element = columns[i];
                  if(undefined!=element.childNodes && element.childNodes.length > 0){
                    if(undefined == element.childNodes[0].tagName){
                    fieldname = element.childNodes[0].textContent;
                    }
                    else{
                    value_curr = element.childNodes[0].value;
                    if(undefined!=value_curr && value_curr!=""){
                    num_fields_entered = num_fields_entered + 1;
                    }
                    if(undefined!=value_curr)
                    {
                      if(fieldname=='Number of Paragraphs' || fieldname=='Number of sentences' || fieldname=='Number of words')
                      {
                        if(value_curr < 0 || (value_curr!="" && positive_integer_regex.test(value_curr)==false)){
                          error_string = fieldname+" "+" has to be >=0";
                          error_msg = error_msg.concat(" ",error_string);
                        } 
                      }
                      else{
                        if(value_curr < 0)
                        {
                          error_string = fieldname+" "+" has to be a positive value";
                          error_msg = error_msg.concat(" ",error_string);
                        }
                      }
                    }
                    }
                  }
                }
                });
              table_2 = document.getElementById('criteria_block_metrics_referntial');
              table_2_rows = table_2.querySelectorAll('tr');
              table_2_rows.forEach((input)=>{
                columns = input.childNodes;
                var fieldname = "";
                for(var i = 0 ; i < columns.length;i++)
                {
                  element = columns[i];
                  if(undefined!=element.childNodes && element.childNodes.length > 0){
                    if(undefined == element.childNodes[0].tagName){
                    fieldname = element.childNodes[0].textContent;
                    }
                    else{
                    value_curr = element.childNodes[0].value;
                    if(undefined!=value_curr && value_curr!=""){
                    num_fields_entered = num_fields_entered + 1;
                    }
                    if(undefined!=value_curr)
                    {
                        if(value_curr < 0){
                          error_string = fieldname+" "+" has to be >=0";
                          error_msg = error_msg.concat(" ",error_string);
                        } 
                    }
                    }
                  }
                }
                });
                table_3 = document.getElementById('criteria_block_metrics_diversity');
                table_3_rows = table_3.querySelectorAll('tr');
                table_3_rows.forEach((input)=>{
                columns = input.childNodes;
                var fieldname = "";
                for(var i = 0 ; i < columns.length;i++)
                {
                  element = columns[i];
                  if(undefined!=element.childNodes && element.childNodes.length > 0){
                    if(undefined == element.childNodes[0].tagName){
                    fieldname = element.childNodes[0].textContent;
                    }
                    else{
                    value_curr = element.childNodes[0].value;
                    if(undefined!=value_curr && value_curr!=""){
                    num_fields_entered = num_fields_entered + 1;
                    }
                    if(undefined!=value_curr)
                    {
                        if(fieldname=='Type token ratio')
                        {
                          if(value_curr < 0 || value_curr > 1)
                          {
                            error_msg = error_msg.concat(" ","Type token ratio has to be between 0 and 1");
                          }
                        }
                        else if(fieldname=='Average Minimium Word frequency')
                        {
                          if(value_curr < 0 || (value_curr!="" && positive_integer_regex.test(value_curr)==false))
                          {
                            error_msg = error_msg.concat(" ","Average minimum word frequency has to be an integer >=0");
                          }
                        }
                        else{
                          if(value_curr < 0)
                          {
                            error_msg = error_msg.concat(" ",fieldname+" has to be >=0");
                          }
                        }
                    }
                    }
                  }
                }
                });
                table_4 = document.getElementById('criteria_block_metrics_syn_complexity');
                table_4_rows = table_4.querySelectorAll('tr');
                table_4_rows.forEach((input)=>{
                columns = input.childNodes;
                var fieldname = "";
                for(var i = 0 ; i < columns.length;i++)
                {
                  element = columns[i];
                  if(undefined!=element.childNodes && element.childNodes.length > 0){
                    if(undefined == element.childNodes[0].tagName){
                    fieldname = element.childNodes[0].textContent;
                    }
                    else{
                    value_curr = element.childNodes[0].value;
                    if(undefined!=value_curr && value_curr!=""){
                    num_fields_entered = num_fields_entered + 1;
                    }
                    if(undefined!=value_curr)
                    {
                        if(fieldname!='Flesch Reading Ease' && fieldname!='Flesch Kincaid Reading Level')
                        {
                          if(value_curr < 0)
                          {
                            error_msg = error_msg.concat(" ",fieldname+" has to be >0");
                          }
                        }
                        else{
                          if(fieldname=='Flesch Reading Ease')
                          {
                            if(value_curr < 0 || value_curr > 100)
                            error_msg = error_msg.concat(" ","Flesch Reading ease has to be between 0 and 100 (inclusive)");
                          }
                          else if(fieldname=='Flesch Kincaid Reading Level')
                          {
                            if(value_curr < 0 || value_curr > 18)
                            error_msg = error_msg.concat(" ","Flesch Kincaid Reading Level has to be between 0 and 18 (inclusive)");
                          }
                        }
                    }
                    }
                  }
                }
                });
                table_5 = document.getElementById('criteria_block_lang');
                table_5_rows = table_5.querySelectorAll('tr');
                table_5_rows.forEach((input)=>{
                columns = input.childNodes;
                var fieldname = "";
                for(var i = 0 ; i < columns.length;i++)
                {
                  element = columns[i];
                  if(undefined!=element.childNodes && element.childNodes.length > 0){
                    if(undefined == element.childNodes[0].tagName){
                    fieldname = element.childNodes[0].textContent;
                    }
                    else{
                    value_curr = element.childNodes[0].value;
                    if(undefined!=value_curr && value_curr!=""){
                    num_fields_entered = num_fields_entered + 1;
                    }
                    if(undefined!=value_curr)
                    {
                       if(value_curr < 0 || value_curr > 0)
                       {
                        error_msg = error_msg.concat(" ",fieldname+" has to be between 0 and 100 (inclusive)");
                       }
                    }
                    }
                  }
                }
                });
                table_6 = document.getElementById('table1');
                table_6_rows = table_6.querySelectorAll('tr');
                table_6_rows.forEach((input)=>{
                columns = input.childNodes;
                var fieldname = "";
                for(var i = 0 ; i < columns.length;i++)
                {
                  element = columns[i];
                  if(undefined!=element.childNodes && element.childNodes.length > 0){
                    if(undefined == element.childNodes[0].tagName){
                    fieldname = element.childNodes[0].textContent;
                    }
                    else{
                    value_curr = element.childNodes[0].value;
                    if(undefined!=value_curr && value_curr!=""){
                    num_fields_entered = num_fields_entered + 1;
                    }
                    if(undefined!=value_curr)
                    {
                      if((fieldname == "Author" || fieldname=="Title") && value_curr!="" && author_regex.test(value_curr)==false)
                      {
                        error_msg = error_msg.concat(" ",fieldname+" should contain at least one letter and should start with a letter");
                      }
                    }
                    }
                  }
                }
                });
                table_7 = document.getElementById('criteria_block_text_info');
                table_7_rows = table_7.querySelectorAll('tr');
                table_7_rows.forEach((input)=>{
                columns = input.childNodes;
                var fieldname = "";
                for(var i = 0 ; i < columns.length;i++)
                {
                  element = columns[i];
                  if(undefined!=element.childNodes && element.childNodes.length > 0){
                    if(undefined == element.childNodes[0].tagName){
                    fieldname = element.childNodes[0].textContent;
                    }
                    else{
                    value_curr = element.childNodes[0].value;
                    if((undefined!=value_curr) && value_curr!=""){
                    if(fieldname!="Authentic" && fieldname!="Simplified")
                    num_fields_entered = num_fields_entered + 1;
                    else
                    {
                      if(element.childNodes[0].checked)
                      num_fields_entered = num_fields_entered + 1;
                    }
                    }
                    if(undefined!=value_curr)
                    {
                      if((fieldname == "Genre" || fieldname=="Type") && value_curr!="" && author_regex.test(value_curr)==false)
                      {
                        error_msg = error_msg.concat(" ",fieldname+" should contain at least one letter and should start with a letter");
                      }
                      else if(fieldname =="Length" && value_curr!="" && (positive_integer_regex.test(value_curr)==false || value_curr < 0))
                      {
                        error_msg = error_msg.concat(" ",fieldname+" should be an integer >=0");
                      }
                    }
                    }
                  }
                }
                });
                if(error_msg!="")
                alert(error_msg);
                if(num_fields_entered == 0)
                alert("Enter atleast one field to proceed to search");
            }
            function displaySingleTab(event)
            {
              if(event.target.name == "Search")
              {
                document.getElementsByClassName('search_tab')[0].style.display = "block";
                document.getElementsByClassName('readability_tab')[0].style.display = "none";
                document.getElementsByClassName('vocab_tab')[0].style.display = "none";
                document.getElementsByClassName('more_results_tab')[0].style.display = "none";
              }
              else if(event.target.name=="Readability")
              {
                document.getElementsByClassName('search_tab')[0].style.display = "none";
                document.getElementsByClassName('readability_tab')[0].style.display = "block";
                document.getElementsByClassName('vocab_tab')[0].style.display = "none";
                document.getElementsByClassName('more_results_tab')[0].style.display = "none";
              }
              else if(event.target.name=="Vocabulary")
              {
                document.getElementsByClassName('search_tab')[0].style.display = "none";
                document.getElementsByClassName('readability_tab')[0].style.display = "none";
                document.getElementsByClassName('vocab_tab')[0].style.display = "block";
                document.getElementsByClassName('more_results_tab')[0].style.display = "none";
              }
              else if(event.target.name=="More_Results")
              {
                document.getElementsByClassName('search_tab')[0].style.display = "none";
                document.getElementsByClassName('readability_tab')[0].style.display = "none";
                document.getElementsByClassName('vocab_tab')[0].style.display = "none";
                document.getElementsByClassName('more_results_tab')[0].style.display = "block";
              }
            }
          </script>
    </head>
    <body>
        <div class="app">
            <div class="header">
                <b>A Linguistic Portal to Spanish in Proficiency</b>
                &nbsp;&nbsp;&nbsp;
                    <div class="dropdown">
                        <button class="dropbtn">Home</button>
                    </div>
                    <div class="dropdown">
                        <button class="dropbtn">Corpus</button>
                        <div class="dropdown-content">
                            <a href="#">Teachers and Learners</a>
                            <a href="#">Researchers</a>
                            <a href="#">Analyze your texts</a>
                            <a href="#">Add to Corpus</a>
                          </div>
                    </div>
                    <div class="dropdown">
                        <button class="dropbtn">Tutorials</button>
                    </div>
                    <div class="dropdown">
                        <button class="dropbtn">Readability</button>
                        <div class="dropdown-content">
                            <a href="#">What is readability?</a>
                            <a href="#">How is readability calculated?</a>
                            <a href="#">Reading and L2 Learning</a>
                          </div>
                    </div>
                    <div class="dropdown">
                        <button class="dropbtn">Contact</button>
                    </div>
            </div>
            <div class="row">
                <div class="column" style="background-color:#aaa;">
                  <h2>Books</h2>
                  {%for res in results%}
                  <tr><td>{{res}}</td></tr>
                  <br/>
                  {%endfor%}

                  <p>Books go here..</p>
                  <p>Books go here..</p>
                  <p>Books go here..</p>
                  <p>Books go here..</p>
                  <p>Books go here..</p>
                  <p>Books go here..</p>
                  <p>Books go here..</p>
                </div>
                <div class="column2" style="background-color:#bbb;">
                <div class="flexbox">
                <div class="dropdown">
                  <input type="button" name="Search" value="Search" name="select_button" class="dropbtn" onclick="displaySingleTab(event)"></input>
                </div>
                <div class="dropdown">
                  <input type="button" name="Readability" value="Readability" name="select_button" class="dropbtn" onclick="displaySingleTab(event)"></input>
                </div>
                <div class="dropdown">
                  <input type="button" name="Vocabulary" value="Vocabulary" name="select_button" class="dropbtn" onclick="displaySingleTab(event)"></input>
                </div>
                <div class="dropdown">
                  <input type="button" name="More_Results" value="More_Results" name="select_button" class="dropbtn" onclick="displaySingleTab(event)"></input>
                </div>
                </div>
                  <div class="search_tab">
                  {%include "searchTemplate.html"%}
                  </div>
                  <div class="readability_tab">
                  <p>Readability</p>
                  </div>
                  <div class="vocab_tab">
                  <p>Vocabulary</p>
                  </div>
                  <div class="more_results_tab">
                  <p>More results</p>
                  </div>

                </div>
              </div>
        </div>
        
              
      
    </body>
</html>